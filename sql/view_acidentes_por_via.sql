create or replace view view_acidentes_por_via as (select *, ("Total Por Logradouro"/"Total")*100::double precision as "%" from (select aux_enderecos.desc_logradouro as "Logradouro", count(*)::double precision as "Total Por Logradouro", (select count(*) from acidentes)::double precision as "Total" from acidentes join aux_enderecos on (acidentes.nomelog = aux_enderecos.cod_logradouro) group by aux_enderecos.desc_logradouro order by "Total Por Logradouro" desc) s group by "Logradouro", "Total Por Logradouro", "Total" order by "Total Por Logradouro" desc)